<!DOCTYPE HTML><html>
<head>
  <title>Enable X Slice Cafe Digital Oven</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" href="data:,">
  <link rel="stylesheet" type="text/css" href="style.css">
<title>ESP Web Server</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="icon" href="data:,">
</head>
<body>
  <div class="topnav">
    <h1 class="topnav name">Enable X Slice Cafe Digital Oven</h1>
  </div>
  <div class="content">
    <div class="card">
      <h2 class="statusstate">Status: </h2>
      <p class="state">Function: Top and bottom heat</p>
      <p class="state">Temp(Â°C): 122/120</p>
      <p class="state">Duration(mins): 30/55</p>
    </div>

    <div class="buttons">
      <div class="toprow">
        <div class="firstSet">
          <div class="first">
            <div class="buttonInner">
              <h2> Fermentation </h2>
              <input disabled id= "function1" type="number" min="1" max="5" value=%defaultF1%>
              <h2>Temperature</h2>
              <input disabled id= "temperature1" type="number" min="1" max="100" value=%defaultT1%>
              <h2>Duration</h2>
              <input disabled id= "duration1" type="number" min="1" max="100" value=%defaultD1%>
              <h2>Function</h2>
              <h2></h2>
            </div>
          </div>
            <button id="setting1" class="settingButton">Setting</button>
            <button id="firstbutton" class="settingButton">Toggle</button>
        </div>
        <div class="secondSet">
          <div class="second">
            <div class="buttonInner">
              <h3> 2 </h3>
              <h2>Temperature</h2>
              <input disabled id= "temperature2" type="number" min="1" max="100" value=%defaultT2%>
              <h2>Duration</h2>
              <input disabled id= "duration2" type="number" min="1" max="100" value=%defaultD2%>
              <h2>Function</h2>
              <input disabled id= "function2" type="number" min="1" max="5" value=%defaultF2%>
              <h2></h2>
            </div>
          </div>
            <button id="setting2" class="settingButton">Setting</button>
            <button id="secondbutton" class="settingButton">Toggle</button>
        </div>
      </div>  
      <div class="bottomrow">
        <div class="thirdSet">
          <div class="third">
            <div class="buttonInner">
              <h3> 3 </h3>
              <h2>Temperature</h2>
              <input disabled id= "temperature3" type="number" min="1" max="100" value=%defaultT3%>
              <h2>Duration</h2>
              <input disabled id= "duration3" type="number" min="1" max="100"  value=%defaultD3%>
              <h2>Function</h2>
              <input disabled id= "function3" type="number" min="1" max="5" value=%defaultF3%>
              <h2></h2>
            </div>
          </div>
            <button id="setting3" class="settingButton">Setting</button>
            <button id="thirdbutton" class="settingButton">Toggle</button>
        </div>
        <div class="fourthSet">
          <div class="fourth">
            <div class="buttonInner">
              <h3> 4 </h3>
              <h2>Temperature</h2>
              <input disabled id= "temperature4" type="number" min="1" max="100" value=%defaultT4%>
              <h2>Duration</h2>
              <input disabled id= "duration4" type="number" min="1" max="100" value=%defaultD4%>
              <h2>Function</h2>
              <input disabled id= "function4" type="number" min="1" max="5" value=%defaultF4%>
              <h2></h2>
            </div>
          </div>
            <button id="setting4" class="settingButton">Setting</button>
            <button id="fourthbutton" class="settingButton">Toggle</button>
        </div>
      </div>
    </div>
  </div>
<script>
  var gateway = `ws://${window.location.hostname}/ws`; //gets the webserver IP address
  var websocket;
  let temperatureInput1 = true;
  let temperatureInput2 = true;
  let temperatureInput3 = true;
  let temperatureInput4 = true;
  window.addEventListener('load', onLoad); //adds listeners to it
  function initWebSocket() {
    console.log('Trying to open a WebSocket connection...');
    websocket = new WebSocket(gateway);
    websocket.onopen    = onOpen;
    websocket.onclose   = onClose;
    websocket.onmessage = onMessage; 
  }
  function onOpen(event) {
    console.log('Connection opened');
  }
  function onClose(event) {
    console.log('Connection closed');
    setTimeout(initWebSocket, 2000);
  }
  function onMessage(event) { //Handles incoming message from the server (esp32 board)
    var state;
    console.log(event);
    if (event.data == "1"){
      state = "ON";
    }
    else{
      state = "OFF";
    }
    document.getElementById('state').innerHTML = state;
  }
  function onLoad(event) {
    initWebSocket();
    initButton();
  }
  function initButton() {
    document.getElementById('button').addEventListener('click', toggle);
    document.getElementById('firstbutton').addEventListener('click', toggle1);
    document.getElementById('secondbutton').addEventListener('click', toggle2);
    document.getElementById('thirdbutton').addEventListener('click', toggle3);
    document.getElementById('fourthbutton').addEventListener('click', toggle4);
    document.getElementById('saveButton').addEventListener('click', toggleSave);

    document.getElementById('setting1').addEventListener('click', () => {
      temperatureInput1 = !temperatureInput1;
      document.getElementById('temperature1').disabled= temperatureInput1;
      document.getElementById('duration1').disabled= temperatureInput1;
      document.getElementById('function1').disabled= temperatureInput1;
    });
    document.getElementById('setting2').addEventListener('click', () => {
      temperatureInput2 = !temperatureInput2;
      document.getElementById('temperature2').disabled= temperatureInput2;
      document.getElementById('duration2').disabled= temperatureInput2;
      document.getElementById('function2').disabled= temperatureInput2;
    });
    document.getElementById('setting3').addEventListener('click', () => {
      temperatureInput3 = !temperatureInput3;
      document.getElementById('temperature3').disabled= temperatureInput3;
      document.getElementById('duration3').disabled= temperatureInput3;
      document.getElementById('function3').disabled= temperatureInput3;
    });
    document.getElementById('setting4').addEventListener('click', () => {
      temperatureInput4 = !temperatureInput4;
      document.getElementById('temperature4').disabled= temperatureInput4;
      document.getElementById('duration4').disabled= temperatureInput4;
      document.getElementById('function4').disabled= temperatureInput4;
    });
  }
  function toggle(){
    //console.log("toggle");
    websocket.send("toggle");
  }
  function toggle1(){
    var temp = document.getElementById("temperature1").value;
    var duration = document.getElementById("duration1").value;
    var func = document.getElementById("function1").value;
    var value= temp+','+duration+','+func
    // console.log(value);
    websocket.send(value);
  }
  function toggle2(){
    var temp = document.getElementById("temperature2").value;
    var duration = document.getElementById("duration2").value;
    var func = document.getElementById("function2").value;
    var value= temp+','+duration+','+func
    //console.log(value);
    websocket.send(value);
  }
  function toggle3(){
    var temp = document.getElementById("temperature3").value;
    var duration = document.getElementById("duration3").value;
    var func = document.getElementById("function3").value;
    var value= temp+','+duration+','+func
    //console.log(value);
    websocket.send(value);
  }
  function toggle4(){
    var temp = document.getElementById("temperature4").value;
    var duration = document.getElementById("duration4").value;
    var func = document.getElementById("function4").value;
    var value= temp+','+duration+','+func
    //console.log(value);
    websocket.send(value);
  }
  function toggleSave(){
    var temp1 = document.getElementById("temperature1").value;
    var duration1 = document.getElementById("duration1").value;
    var func1 = document.getElementById("function1").value;
    var temp2 = document.getElementById("temperature2").value;
    var duration2 = document.getElementById("duration2").value;
    var func2 = document.getElementById("function2").value;
    var temp3 = document.getElementById("temperature3").value;
    var duration3 = document.getElementById("duration3").value;
    var func3 = document.getElementById("function3").value;
    var temp4 = document.getElementById("temperature4").value;
    var duration4 = document.getElementById("duration4").value;
    var func4 = document.getElementById("function4").value;
    websocket.send(`save,${temp1}\n${duration1}\n${func1}\n${temp2}\n${duration2}\n${func2}\n${temp3}\n${duration3}\n${func3}\n${temp4}\n${duration4}\n${func4}`);
  }

</script>
</body>
</html>